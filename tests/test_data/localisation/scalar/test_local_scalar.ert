-- ==============================================================================
-- References:
-- ERT wiki: https://wiki.statoil.no/wiki/index.php/ERT_main_page
-- FMU wiki: https://wiki.statoil.no/wiki/index.php/FMU_portal_home
--
-- ==============================================================================


-----------------------------------------------------
-- SECTION: Internal variables
-----------------------------------------------------|
JOBNAME scalar_local_%d
DEFINE  <USER>            $USER
DEFINE  <SCRATCH>         scratch
DEFINE  <CASE_DIR>        scalar_local

----------------------------------------------------
-- SECTION: Eclipse, runpath and storage settings
-----------------------------------------------------

RUNPATH                 <SCRATCH>/<USER>/<CASE_DIR>/realization-%d/iter-%d/   -- Runpath from where all realizations are run
ENSPATH                 output/storage/<CASE_DIR>                       -- Path for internal ERT data
LOG_FILE                output/log/<CASE_DIR>.log                          -- Ert log file
UPDATE_LOG_PATH        output/update_log/<CASE_DIR>                       -- Storage of update log (list of active and inactive data points)
RUNPATH_FILE            output/run_path_file/.ert-runpath-list_<CASE_DIR>  -- Resulting list of runpaths for the simulations

 -----------------------------------------------------
-- SECTION: LSF settings, HM configuration etc.
-----------------------------------------------------

NUM_REALIZATIONS    100                  -- Number of realizations to run
MAX_RUNTIME         1800                     -- Maximum allowed run time (in seconds)
MIN_REALIZATIONS    5                      -- Minimum number of realizations that must have succeeded for /
                                                                 -- the ensemble to be regarded a success

-- QUEUE_SYSTEM        LOCAL
-- QUEUE_OPTION        LOCAL MAX_RUNNING 8

QUEUE_SYSTEM  LSF                     -- Use the LSF cluster to run simulations
QUEUE_OPTION  LSF   LSF_SERVER   $ERT_LSF_SERVER
QUEUE_OPTION  LSF   LSF_QUEUE     mr   -- Use Redhat 7 queue for RMS12
QUEUE_OPTION  LSF   MAX_RUNNING 100     -- Choke the number of simultaneous run
MAX_SUBMIT          1                       -- How many times should the queue system retry failed /
                                                           -- simulations. Default = 2 (use 1 when debugging)


-----------------------------------------------------
-- SECTION: Install jobs and workflows needed
-----------------------------------------------------
-- LOAD_WORKFLOW          local_config_workflow_add LOCALISATION_WORKFLOW
-- LOAD_WORKFLOW          local_config_workflow_remove LOCALISATION_WORKFLOW
LOAD_WORKFLOW          local_config_workflow_remove_2 LOCALISATION_WORKFLOW
-- LOAD_WORKFLOW          local_config_workflow_add_2 LOCALISATION_WORKFLOW
HOOK_WORKFLOW         LOCALISATION_WORKFLOW  PRE_FIRST_UPDATE

INSTALL_JOB EVALUATE_SCALAR evaluate_scalar_job
-- MULTX1 and PERM has effect on RESULT_X
-- MULTY1 and PERM has effect on RESULT_Y
-- MULTX2 and PERM has effect on RESULT2_X
-- MULTY2 and PERM has effect on RESULT2_Y


GEN_KW MULTX1      multx1.tmpl   multx1.dat   multx1.dist
GEN_KW MULTY1      multy1.tmpl   multy1.dat   multy1.dist
GEN_KW PERM           perm.tmpl   perm.dat     perm.dist

GEN_KW MULTX2      multx2.tmpl   multx2.dat   multx2.dist
GEN_KW MULTY2      multy2.tmpl   multy2.dat   multy2.dist


FORWARD_MODEL EVALUATE_SCALAR


GEN_DATA RESULT_X      RESULT_FILE:RESULT_X_%d.dat    REPORT_STEPS:0 INPUT_FORMAT:ASCII OUTPUT_FORMAT:ASCII
GEN_DATA RESULT_Y      RESULT_FILE:RESULT_Y_%d.dat    REPORT_STEPS:0 INPUT_FORMAT:ASCII OUTPUT_FORMAT:ASCII
GEN_DATA RESULT2_X   RESULT_FILE:RESULT2_X_%d.dat    REPORT_STEPS:0 INPUT_FORMAT:ASCII OUTPUT_FORMAT:ASCII
GEN_DATA RESULT2_Y   RESULT_FILE:RESULT2_Y_%d.dat    REPORT_STEPS:0 INPUT_FORMAT:ASCII OUTPUT_FORMAT:ASCII
OBS_CONFIG  observations/observations.txt
TIME_MAP time_map.txt
